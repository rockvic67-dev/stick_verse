<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StickVerse</title>
<style>
body { 
  margin:0; 
  font-family:'Segoe UI', sans-serif; 
  background:linear-gradient(-45deg,#0f0f1a,#1a1a2e,#16213e,#0f3460);
  background-size:400% 400%;
  animation:gradientBG 12s ease infinite;
  color:white; 
  overflow-x:hidden;
}
@keyframes gradientBG {
  0% { background-position:0% 50%; }
  50% { background-position:100% 50%; }
  100% { background-position:0% 50%; }
}
header { 
  display:flex; 
  justify-content:space-between; 
  align-items:center; 
  padding:15px 40px; 
  background:rgba(20,20,40,0.9); 
  backdrop-filter:blur(10px);
}
header h1 { 
  color:#00f2ff; 
  cursor:pointer; 
  transition:0.3s;
}
header h1:hover { text-shadow:0 0 15px #00f2ff; }
nav a { 
  color:white; 
  margin-left:20px; 
  text-decoration:none; 
  cursor:pointer;
  transition:0.3s;
}
nav a:hover { color:#ff00c8; }
section { display:none; padding:60px 20px; text-align:center; animation:fadeIn 0.6s ease; }
@keyframes fadeIn { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }
.active-section { display:block; }
input { display:block; margin:15px auto; padding:12px; width:250px; border-radius:6px; border:none; outline:none; transition:0.3s; }
input:focus { box-shadow:0 0 10px #00f2ff; }
button { padding:12px 30px; border:none; border-radius:8px; background:linear-gradient(45deg,#00f2ff,#ff00c8); color:white; cursor:pointer; margin-top:10px; transition:0.3s; }
button:hover { transform:scale(1.05); box-shadow:0 0 15px #ff00c8; }
.hero { position:relative; padding-top:80px; }
.hero::before { content:""; position:absolute; top:-100px; left:50%; transform:translateX(-50%); width:600px; height:600px; background:radial-gradient(circle, rgba(0,242,255,0.25) 0%, rgba(255,0,200,0.15) 40%, transparent 70%); animation:pulseLight 4s ease-in-out infinite; z-index:0; }
@keyframes pulseLight { 0% { transform:translateX(-50%) scale(1); opacity:0.7; } 50% { transform:translateX(-50%) scale(1.2); opacity:1; } 100% { transform:translateX(-50%) scale(1); opacity:0.7; } }
.hero h2 { font-size:2.5rem; position:relative; z-index:1; animation:floatText 3s ease-in-out infinite; text-shadow: 0 0 10px #00f2ff, 0 0 20px #00f2ff, 0 0 40px #ff00c8, 0 0 80px rgba(255,0,200,0.6); }
@keyframes floatText { 0% { transform:translateY(0px); } 50% { transform:translateY(-10px); } 100% { transform:translateY(0px); } }
.grid { display:flex; justify-content:center; gap:20px; flex-wrap:wrap; margin-top:40px; }
.card { background:#1c1c2e; padding:15px; border-radius:10px; width:200px; transition:0.3s; opacity:0; transform:translateY(40px); animation:cardReveal 0.8s ease forwards; position:relative; overflow:hidden; transform-style:preserve-3d; }
.card:nth-child(1) { animation-delay:0.2s; }
.card:nth-child(2) { animation-delay:0.4s; }
.card:nth-child(3) { animation-delay:0.6s; }
@keyframes cardReveal { to { opacity:1; transform:translateY(0); } }
.card::before { content:""; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(120deg, transparent, rgba(255,255,255,0.2), transparent); transition:0.6s; }
.card:hover::before { left:100%; }
.card:hover { transform:translateY(-15px) scale(1.07) rotateX(6deg) rotateY(-6deg); box-shadow:0 25px 50px rgba(0,0,0,0.6), 0 0 20px rgba(0,242,255,0.5); }
.card img { transition:0.5s; width:100%; border-radius:8px; }
.card:hover img { transform:scale(1.08); }
</style>
</head>
<body>
<header>
  <h1 onclick="showSection('home')">StickVerse</h1>
  <nav>
    <a onclick="showSection('home')">Home</a>
    <a onclick="showSection('login')">Login</a>
    <a onclick="showSection('signup')">Sign Up</a>
    <a onclick="showSection('profile')">Profile</a>
  </nav>
</header>

<!-- HOME -->
<section id="home" class="active-section hero">
  <h2>Stream Your Favorite Anime</h2>
  <p>Unlimited episodes. Zero boredom.</p>
  <div style="text-align:center; margin:40px;">
    <input type="text" id="searchInput" placeholder="Search anime..." style="padding:12px 20px; width:300px; border-radius:30px; border:none; outline:none;">
  </div>
  <div class="grid" id="animeGrid">
    <div class="card"><img src="https://via.placeholder.com/200x250"><h3>Naruto</h3></div>
    <div class="card"><img src="https://via.placeholder.com/200x250"><h3>Attack on Titan</h3></div>
    <div class="card"><img src="https://via.placeholder.com/200x250"><h3>Demon Slayer</h3></div>
  </div>
</section>

<!-- LOGIN -->
<section id="login">
  <h2>Login</h2>
  <input type="email" id="loginEmail" placeholder="Email" />
  <input type="password" id="loginPassword" placeholder="Password" />
  <button onclick="login()">Login</button>
</section>

<!-- SIGNUP -->
<section id="signup">
  <h2>Create Account</h2>
  <input type="email" id="signupEmail" placeholder="Email" />
  <input type="password" id="signupPassword" placeholder="Password" />
  <button onclick="signup()">Sign Up</button>
</section>

<!-- PROFILE -->
<section id="profile">
  <h2>Your Profile</h2>
  <p id="userEmail"></p>
  <img id="profilePreview" width="120" style="border-radius:50%; margin-top:20px; display:none;">
  <input type="file" id="profilePicUpload" accept="image/*">
  <button onclick="logout()">Logout</button>
</section>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, arrayUnion, updateDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyA23V1vAXR9GmPlSzpcoxNdIelA97okhtg",
  authDomain: "stickverse-6998b.firebaseapp.com",
  projectId: "stickverse-6998b",
  storageBucket: "stickverse-6998b.appspot.com",
  messagingSenderId: "592639288866",
  appId: "1:592639288866:web:f3e5cbf0ac4a35bf72cc7b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const storage = getStorage(app);

window.showSection = function(id) {
  document.querySelectorAll('section').forEach(sec => sec.classList.remove('active-section'));
  document.getElementById(id).classList.add('active-section');
}

window.login = function() {
  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;
  signInWithEmailAndPassword(auth, email, password)
    .then(userCredential => {
      showSection('profile');
      initProfile(userCredential.user);
    })
    .catch(err => alert(err.message));
}

window.signup = function() {
  const email = document.getElementById('signupEmail').value;
  const password = document.getElementById('signupPassword').value;
  createUserWithEmailAndPassword(auth, email, password)
    .then(userCredential => {
      showSection('profile');
      initProfile(userCredential.user);
    })
    .catch(err => alert(err.message));
}

window.logout = function() {
  signOut(auth).then(() => showSection('home'));
}

onAuthStateChanged(auth, user => {
  if(user) {
    showSection('profile');
    initProfile(user);
  }
});

function initProfile(user) {
  document.getElementById('userEmail').textContent = `Logged in as: ${user.email}`;
  getDoc(doc(db,'users',user.uid)).then(docSnap=>{
    if(docSnap.exists() && docSnap.data().photoURL){
      const img = document.getElementById('profilePreview');
      img.src = docSnap.data().photoURL;
      img.style.display = 'block';
    }
  });
}

// Profile picture upload
document.getElementById("profilePicUpload").addEventListener("change", async (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  const user = auth.currentUser;
  if(!user) return alert("Login required");
  const picRef = ref(storage, `profilePics/${user.uid}`);
  await uploadBytes(picRef, file);
  const url = await getDownloadURL(picRef);
  await setDoc(doc(db,'users',user.uid), { photoURL:url }, { merge:true });
  const img = document.getElementById('profilePreview');
  img.src = url;
  img.style.display='block';
});

// Search filter
window.addEventListener("DOMContentLoaded", () => {
  const searchInput = document.getElementById("searchInput");

  searchInput.addEventListener("input", () => {
    const value = searchInput.value.toLowerCase();
    const cards = document.querySelectorAll(".grid .card");

    cards.forEach(card => {
      const titleElem = card.querySelector("h3");
      const title = titleElem.textContent.toLowerCase();

      if(title.includes(value)) {
        card.style.display = "block";

        // Highlight matching part
        if(value) {
          const regex = new RegExp(`(${value})`, "gi");
          titleElem.innerHTML = titleElem.textContent.replace(regex, "<span style='background:#ff00c8; color:white;'>$1</span>");
        } else {
          // Reset highlight if search is cleared
          titleElem.innerHTML = titleElem.textContent;
        }

      } else {
        card.style.display = "none";
      }
    });
  });
});
</script>
</body>
</html>
